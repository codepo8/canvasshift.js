<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Demo Animations</title>
  <style>
    #canvas {
      width: 300px;
      height: 200px;
      position: relative;
      background: grey;
    }
    #slice {
      background: red;
      position: absolute;
      z-index: 2;
    }
    #rest {
      position: absolute;
      background: blue;
    }
    #buttons {
      margin: 1em 0;
    }
    .animating #buttons {
      opacity: .2;
    }

  </style>
</head>
<body>


<div id="canvas">
  <div id="slice"></div>
  <div id="rest"></div>
</div>

<div id="buttons">
  <button id="left">Shift left</button>
  <button id="right">Shift right</button>
  <button id="up">Shift up</button>
  <button id="down">Shift down</button>
</div>  

<script>

let buttons = document.querySelector('#buttons');
let slice = document.querySelector('#slice');
let rest = document.querySelector('#rest');

let i = 0;
let ani = null;
let delay = 1000;
let props = 0;
let changes = 0;
let translate = {x:'left','y':'top',w:'width',h:'height',o:'opacity'};

let animation = {
  left:{
    setup: [
      {element: '#slice', x: 0, y: 0, w: 20, h: 200},
      {element: '#rest', x: 20, y: 0, w: 280, h: 200},
    ],
    frames: [
      {element: '#slice', x: 310},
      {element: '#rest', x: 0, y: 0},
      {element: '#slice', x: 280}
    ]
  },
  up: {
    setup: [
      {element: '#slice', x: 0, y: 0, w: 300, h: 20},
      {element: '#rest', x: 0, y: 20, w: 300, h: 180}
    ],
    frames: [
      {element: '#slice', x: 10, y: 5},
      {element: '#slice', x: 10, y: 175},
      {element: '#rest', x: 0, y: 0},
      {element: '#slice', x: 0, y: 180},
    ]
  },
  down: {
    setup: [
      {element: '#slice', x: 0, y: 180, w: 300, h: 20},
      {element: '#rest', x: 0, y: 0, w: 300, h: 180}
    ],
    frames: [
      {element: '#slice', x: 10, y: 175},
      {element: '#rest', x: 0, y: 20},
      {element: '#slice', x: 10, y: 5},
      {element: '#slice', x: 0, y: 0},
    ]
  },
  right:{
    setup: [
      {element: '#slice', x: 280, y: 0, w: 20, h: 200},
      {element: '#rest', x: 0, y: 0, w: 280, h: 200}
    ],
    frames: [
      {element: '#slice', x: 310, y: 0},
      {element: '#rest', x: 20, y: 0},
      {element: '#slice', x: 0, y: 0}
    ]
  },
};

document.body.addEventListener('click', e => {
  if (!document.body.classList.contains('animating')){
    let id = e.target.id;
    if (id) {
      animation[id].setup.forEach(a => {
        let elm = document.querySelector(a.element);
        elm.style.transition = '';
        elm.style.top = a.y + 'px';
        elm.style.left = a.x + 'px';
        elm.style.width = a.w + 'px';
        elm.style.height = a.h + 'px';
        elm.style.opacity = 1;
      });
      i = 0;
      ani = animation[id].frames;
      document.body.className = 'animating';
      window.setTimeout(shift, delay);
    }
  }
});

const shift = e => {
  if (ani[i]) {
    console.log(i,ani[i])
    let elm = document.querySelector(ani[i].element);
    let time = ani[i].time || '1000';
    let delay = ani[i].delay ? ' ' + ani[i].delay+'ms' : '';
    if (ani[i].y) {
      elm.style.top = `${ani[i].y}px`;
    }
    if (ani[i].x) {
      elm.style.left = `${ani[i].x}px`;
    }
    if (ani[i].w) {
      elm.style.width = `${ani[i].w}px`;
    }
    if (ani[i].h) {
      elm.style.height = `${ani[i].h}px`;
    }
    if (ani[i].o) {
      elm.style.opacity = `${ani[i].o}`;
    }
    elm.style.transition = `all ${time}ms${delay}`;
    i++;
    let recall = +time + (delay ? delay.replace(' ','') : 0);
    window.setTimeout(shift, recall)
  } else {
    document.body.className = '';
  }
}


</script>

</body>
</html>